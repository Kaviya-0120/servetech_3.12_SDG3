{% extends "base.html" %}

{% block content %}
<h1 style="margin-bottom: 2rem; color: var(--text-main);">Hospital Overview</h1>

<div class="dashboard-grid">
    <div class="stat-card">
        <div class="stat-icon">üë•</div>
        <div class="stat-info">
            <h3>{{ stats['total_patients'] }}</h3>
            <p>Total Patients Registered</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon">üè•</div>
        <div class="stat-info">
            <h3>{{ stats['dept_stats']|length }}</h3>
            <p>Active Departments</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon">‚è≥</div>
        <div class="stat-info">
            <h3>12m</h3>
            <p>Avg. Wait Time</p>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        Recent Activity
        <a href="{{ url_for('queue') }}"
            style="float: right; font-size: 0.9rem; text-decoration: none; color: var(--primary-color);">View All</a>
    </div>
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Patient</th>
                    <th>Department</th>
                    <th>Priority</th>
                </tr>
            </thead>
            <tbody>
                {% for p in stats['recent_patients'] %}
                <tr>
                    <td>{{ p['timestamp'].split(' ')[1] if p['timestamp'] else 'Just now' }}</td>
                    <td>{{ p['name'] }}</td>
                    <td>{{ p['dept_name'] }}</td>
                    <td><span class="badge badge-{{ p['priority_level']|lower }}">{{ p['priority_level'] }}</span></td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4">No recent activity.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}